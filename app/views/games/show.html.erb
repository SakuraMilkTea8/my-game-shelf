<div class="container">

  <div class="game-row">
    <div class="rounded-box col-lg-7 col-sm-12">
      <%= image_tag @game.image_url, class: "show-game-image" %>
    </div>

    <div class="col-lg-5 col-sm-12">
      <div class="card ratings-card p-2">
      <h1 class="game-title"><%= @game.title %></h1>
        <div class="star-container">
          <% @rating.times do %>
            <%= image_tag('icons/star-full.svg', class: "star rating") %>
          <% end %>
          <% if @rating == 0 %>
            <p class="rating-notification">
              Be the First to Rate!
            </p>
            <% (5 - @rating).times do %>
              <%= image_tag('icons/star-empty.svg', class:"star no-rating") %>
            <% end %>
          <% else %>
            <% (5 - @rating).times do %>
              <%= image_tag('icons/star-empty.svg', class: "star rating-remainder") %>
            <% end %>
          <% end %>
        </div>

        <% if user_signed_in? %>
          <!--adding games to users' shelves-->
          <%= simple_form_for(@shelf_game) do |f| %>
            <%= hidden_field_tag(:game, @game.id) %>
            <%= f.label "Add to My Game Shelf" %>
            <div class="shelf-select">
              <%= f.input_field :category, collection: ['want to play', 'now playing', 'completed'], default: 'want to play' %>
              <%= f.button :button do %>
                <%= image_tag('icons/plus.svg') %>
              <% end %>
            </div>
          <% end %>
          <!--Checking status of game (make into a partial) -->
          <!--persisted checks if it is saved -->
          <% if @shelf_game.persisted? %>
            This game is on your shelf under <%= @shelf_game.category %>
          <% end %>
        <% end %>

        <% if @streams.empty? %>
          No one is streaming <%= @game.title %> right now... Come back later!
        <% else %>
          <a href="https://www.twitch.tv/<%= @preview_stream['user_login'] %>" class="twitch-preview" target="_blank">
            Watch <%= @preview_stream['user_name'] %> play <%= @game.title %> right now!
          <%= image_tag(@thumbnail_url, class: 'preview-thumbnail') %>
          </a>
        <% end %>
      </div>
    </div>
  </div>

  <div class="row">
    <div class="col-6">
      <div class="card p-4">
        <p> <%= @game.genre.split(",").join(", ") %></p>
        <p> <%= @game.developer.split(",").join(", ") %></p>
        <p> <%= @game.console.split(",").join(", ") %></p>
        <%= @game.description %>
      </div>
    </div>
    <!-- youtube trailer -->
    <div class="col-6">
      <div class="card p-4">
        <iframe width="450" height="392"
      src="https://www.youtube.com/embed/<%= @one_game_id %>?controls=1&mute=1", class="trailer-image">
        </iframe>
      </div>
    </div>
  </div>

  <div class="reviews">
    <div class="reviews card p-4">
      <% if user_signed_in? %>
        <h3>Reviews for <%= @game.title %></h3>
        <!--partial for the review form -->
        <%= render 'reviews/form', game: @game, review: @review %>
      <% else %>
      <% end %>
      <h1></h1>
      <!--partial for the shelf of reviews -->
      <%= render 'reviews/review' %>
    </div>
  </div>

  <h3>You may also like</h3>
  <div class="recommended-game-cards">
    <!-- Recommends (max) 3 games by genre not including current game -->
    <% @three_games.each do |game| %>
      <%= link_to game_path(game) do %>
        <div class="game-card">
          <img src="<%= game.image_url %>" alt="Boxart for <%= game.title %>">
          <h3>
            <%= game.title %>
          </h3>
        </div>
      <% end %>
    <% end %>
  </div>
</div>
