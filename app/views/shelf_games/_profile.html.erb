<div class="container">
  <div class="row">
    <div class="col-6">
      <h1><%if current_user.avatar.attached? %>
            <%= cl_image_tag(@user.avatar.key, class: "avatar")%>
          <% else %>
            <%= image_tag "gamepad.png", class: "avatar" %>
          <% end %><%= @user.name %>'s profile
      </h1>
      <!-- This shows the user's reviews -->
      <h1>Reviews</h1>
      <% @user.reviews.each do |review| %>
        <div class="rounded-box-reviews">
          <ul class="list-group list-group-flush">
            <li class ="review-user">
              <%= review.game.title %>
              <%= link_to "Visit", game_path(review.game), class: 'btn btn-secondary btn-sm w-4px'  %>
              <% review.rating.times do %>
                <%= image_tag('icons/star-full.svg', class: "review-star") %>
              <% end %>
              <% (5 - review.rating).times do %>
                <%= image_tag('icons/star-empty.svg', class: "review-star") %>
              <% end %>
            <li class ="review-time"> <small><%= time_ago_in_words(review.created_at) %> ago</small></p>
            <li class="review-content">"<%= review.content %>"</p>
          </ul>
          <%= image_tag review.game.image_url, class: "review-image" %>
        </div>
      <% end %>
    </div>
    <div class="favorites">
      <!-- This shows the user's follow list or other user's name to follow -->
      <% if @user != current_user  %>
        <div class="user-list">
          <h1>follow this user</h1>
          <div class="d-flex">
            <h3 class="follow-user"><%= @user.name  %>
              <%= link_to toggle_favorite_user_path(@user), remote: true, method: :post do %>
                <%= render 'users/like_button', user: @user %>
              <% end %>
            </h3>
            </div>
            <!-- Shows user graph -->
              <h1>My shelf data</h1>
              <canvas id="myChart" data-page-views="<%=@graph_array %>"></canvas>
            <div class="graph">
          </div>
        <% end %>
      </div>
      <!-- User's following list -->
      <% if @user == current_user %>
        <h1>Following</h1>
        <% @favorite_users.each do |user| %>
          <div class="favorite" data-id="<%= user.id %>">
            <ul class="friend-list clearfix">
              <%= link_to user_path(user) do %>
                <li class="friend-img"> <%= image_tag "avatar.png" %> </li>
                <li class="friend-info">
                  <h4><%= user.name %></li>
                  <li class="friend-info">Followers: <%= user.reviews.count %>, Games: <%= user.games.count%></li>
                <% end %>
              </ul>
            </div>
          <% end %>
          <!-- Shows user graph -->
          <div class="graph">
            <h1>My shelf data</h1>
            <canvas id="myChart" data-page-views="<%=@graph_array %>"></canvas>
          </div>
        <% else %>
          <p></p>
        <% end %>
      </div>
      <h1>Latest shelf update</h1>
      <div class="rounded-box-updates ">
              <ul class="list-group list-group-flush">
              <p class ="review-user">
        <%= @category.capitalize %>:
        <% @latest_game.each do |content| %>
        <%= content.title %>
        </p>
        <%= image_tag content.image_url, class: "review-image" %>
        <p class ="review-time">Added <%= time_ago_in_words(content.created_at) %> ago</p>
        <% end %>
        </ul>
    </div>
  </div>
</div>
